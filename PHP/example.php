<?php

	require_once('mailerloop.php');

	$MailerLoop = new MailerLoop( 'x0d8r0v6v2z1l0y9w5u4k7z2u8i3x2c6_222');
	$variables = array(
	  'url' => '',
	  'subscr_url' => '',
	  'username' => '',
	  'total_results' => '',
	  'nariai' => array(
	     array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
	    array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
		array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
	  ),
	  'nariai1' => array(
	     array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
	    array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
		array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
	  ),
	  'nariai2' => array(
	     array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
	    array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
	    ),
		array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
		 array(
		   'nario_foto_nuoroda' => 'http://www.google.lt/',
		   'nario_foto' => 'http://www.titleist-golf-clubs.co.uk/titleist%20905.JPG',
		   'nario_nuoroda' => 'http://www.google.lt/',
		   'narys' => 'asdfasdf',
		   'amz' => '55 m.',
		   'miestas' => 'Vilnius',
		   'salis' => 'Lietuva',
		),
	  ),
	);
$MailerLoop->setVariables( $variables )->setRecipient( 'tomas@talandis.lt', 'tomas t')->setFromName( 'BirutÄ—')->setFromEmail( 'birute@geradieta.lt')->setTemplate( 2477 )->setLanguage( 'LT' )->send();


	die('asdasd');

	// $MailerLoop = new MailerLoop( 'e15ab2614576d5f67e5a478cdeb76834');
	// $variables = array(
	//   'url' => 'asdfasdf',
	//   'email' => 'asdfasdf',
	//   'password' => 'asdfasdfasdf',
	// );
	// $MailerLoop
	// 	->setVariables( $variables )
	// 	->setRecipient( 'tomas@talandis.lt')
	// 	->setTemplate( 634 )
	// 	->setLanguage( 'LT' )
	// 	->addAttachment( 'paveiksliukas.jpg', file_get_contents( dirname( __FILE__ ) . '/007.jpg') )
	// 	->send();
	//
	// die('aasd');
	//
	$MailerLoop = new MailerLoop( 'e15ab2614576d5f67e5a478cdeb76834' );

	$recipients = array(
//	   array('email' => 'tomas@talandis.lt', 'variables' => array('name' => 'Tomas'), 'attachments' => array( array('filename' => 'paveiksliukas.jpg', 'content' => file_get_contents( dirname( __FILE__ ) . '/007.jpg') ) ) ),
//	   array('email' => 'tomas+2@talandis.lt', 'variables' => array('name' => 'Tomas2'), 'attachments' => array( array('filename' => 'paveikslas.jpg', 'content' => file_get_contents( dirname( __FILE__ ) . '/007.jpg') ) ) ),
//	   array('email' => 'tomas+3@talandis.lt', 'variables' => array('name' => 'Tomas3') ),
	);

	$MailerLoop->addRecipients( $recipients )->setTemplate( 634 )->setLanguage( 'LT' )->send();

	die('aasd2');
/*
?>

<form action="http://api.mailerloop.lan/mailerserver/send" method="post">

<?php foreach ( $recipients as $k => $recipient ) { ?>
    <input type="text" name="batch[<?php echo $k; ?>][email]" value="<?php echo $recipient['email']; ?>" /><br />
    <input type="text" name="batch[<?php echo $k; ?>][variables][name]" value="<?php echo $recipient['variables']['name']; ?>" /><br />
<?php } ?>

    <input type="text" name="templateId" value="638" /><br />
    <input type="text" name="apiKey" value="e15ab2614576d5f67e5a478cdeb76834" /><br />

    <input type="submit" />

</form>

<?php
    die( '<span style="color: #0A0;">'. __FILE__ .'</span>:'. __LINE__ );
*/

//	$MailerLoop->setTemplate( 638 )->addRecipients( $recipients )->send();
/*

	foreach ( $recipients as $recipient ) {
    	$MailerLoop->addRecipient( $recipient['email'], $recipient['variables'] );
	}

	$MailerLoop->setTemplate( 638 )->send();

die( '<span style="color: #0A0;">'. __FILE__ .'</span>:'. __LINE__ );
*/


    $result = $MailerLoop->setVariables( $recipients[0]['variables'] )->setRecipient( $recipients[0]['email'] )->setTemplate( 638 )->send();

	echo $result;

die( '<span style="color: #0A0;">'. __FILE__ .'</span>:'. __LINE__ );


	$MailerLoop = new MailerLoop( 'v4s8p4e0t2k6v5p7a1t4b1b1w9l0d8i3');
	$variables = array(
	  'uzsakymo_ID' => '123456',
	  'products' => array(
	     array(
	       'link' => 'http://www.google.lt/',
	       'title' => 'CLS350',
	       'suma' => '123123.00 Lt',
	    ),
		 array(
	       'link' => 'http://www.google.lt',
	       'title' => 'W221',
	       'suma' => '123123.00 Lt',
	    ),
	  ),
	  'products1' => array(
	     array(
	       'link' => 'http://www.google.lt/',
	       'title' => 'CLS350',
	       'suma' => '123123.00 Lt',
	    ),
		 array(
	       'link' => 'http://www.google.lt',
	       'title' => 'W221',
	       'suma' => '123123.00 Lt',
	    ),
	  ),
	  'products2' => array(
	     array(
	       'link' => '',
	       'title' => 'asdfasdf',
	       'text' => 'asdfas dfasdfasdfasdf afdsf',
	    ),
	     array(
	       'link' => '',
	       'title' => 'asdfasdf',
	       'text' => 'asdfas dfasdfasdfasdf afdsf',
	    )
	  ),
	);

	$result = $MailerLoop->setVariables( $variables )
                     ->setRecipient( 'tomas@talandis.lt' )
                     ->setTemplate( 620 )
                      ->send();

	var_dump( $result );

